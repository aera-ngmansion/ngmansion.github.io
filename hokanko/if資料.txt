


・BGMの移植（midi）
これはちょっと特殊なやり方なので参考にならないかもしれません。
sappy2006mod10.1を使用します
Midi2GBAを使用します

①
まず最初にGジェネレーション アドバンスに使われているinstデータ（D59924）を移植します。
キャッスルヴァニア 暁月の円舞曲、ユグドラユニオン、リヴィエラなどのinstでも同じような事ができると思われます
まず烈火のinstを使用しない理由ですが・・・（ここから怪しいです、間違ってる可能性大）
烈火のinstは楽器セットがたくさんある、という形式になっています。
なので曲によって楽器セットが違う事になります。
一つ一つの楽器セットには、おそらく５～６個くらいの楽器が含まれています。
逆に言えば一つの楽器セットでは限定された５～６個の楽器しか使用できないという事になります。

烈火のinstの例え
楽器セット１→トランペット、トロンボーン、フルート、ホルン、バイオリン
楽器セット２→トロンボーン、ピアノ、リコーダー、ギター、オルゴール
楽器セット３→リコーダー、鉄琴、トランペット、ブラス、ドラム

楽器セット１ではトランペット、トロンボーン、フルート、ホルン、バイオリンが使えます。
楽器セット２→トロンボーン、ピアノ、リコーダー、ギター、オルゴールが使えます。
ここで問題なのは、トロンボーンとブラスを同時に使う事ができないという事にあります。
あるいはギターを使うには楽器セット２を使うしかない、という事になりかねません。
実際には楽器セットがたくさんあるので問題はないのですが、
どの楽器セットがどんな楽器を使えるかを、一つ一つ調べる必要があります（多分）
または
楽器セット１→トランペット、ピアノ、フルート、ブラス、バイオリンというように
楽器セットの楽器を入れ替える方法もありますが、非常に大変です。
（楽器セット１を使っている曲全てに適応してしまうため）

そこで今回移植したinst使用するという事になります。
このinstは上と同じように例えると

楽器セット1→トランペット、トロンボーン、フルート、ホルン、バイオリン、
ピアノ、リコーダー、ギター、オルゴール、鉄琴、ブラス、ドラム

となります。
つまり一つの楽器セットで多くの楽器を使用可能という事です。
楽器セット1の楽器を調べればすむので非常に簡単というわけです。

②
次にmidiの調整方法になります(midiの形式についてはほとんど気にしなくていいと思います）
お好みのシーケンサで楽器と音量を変える必要があります。

　　　調整前　　　　　　　　　　　　　　　　　　　　調整後
１８トラック（１８楽器）の全１チャンネル　　６トラック（６楽器）の全３チャンネル
　　楽器１　　音量１００　　　　　　　　　　　楽器１　　音量３５
　　楽器２　　音量　９５　　　　　　　　　　　楽器１　　音量３５
　　楽器３　　音量　９０　　　　　　　　　　　楽器１　　音量３５
　　楽器４　　音量　９５　　　　　　　　　　　楽器２　　音量３５
　　楽器５　　音量１００　　　　　　　　　　　楽器２　　音量３５
　　楽器６　　音量　９５　　　　　　　　　　　楽器２　　音量３５
　　楽器７　　音量　９０　　　　　　　　　　　楽器３　　音量３５
　　楽器８　　音量　８０　　　　　　　　　　　楽器３　　音量３５
　　楽器９　　音量　８５　　　　　→　　　　　楽器３　　音量３５
　　楽器１０　音量　８０　　　　　　　　　　　楽器４　　音量３５
　　楽器１１　音量　７５　　　　　　　　　　　楽器４　　音量３５
　　楽器１２　音量１２０　　　　　　　　　　　楽器４　　音量３５
　　楽器１３　音量１１０　　　　　　　　　　　楽器５　　音量３５
　　楽器１４　音量　９０　　　　　　　　　　　楽器５　　音量３５
　　楽器１５　音量　６０　　　　　　　　　　　楽器５　　音量３５
　　楽器１６　音量　７０　　　　　　　　　　　楽器６　　音量３５
　　楽器１７　音量　５０　　　　　　　　　　　楽器６　　音量３５
　　楽器１８　音量　８５　　　　　　　　　　　楽器６　　音量３５


楽器の数と音量によってトラックとチャンネルという言葉をよく使います。

楽器→トラック　
チャンネル→同じ楽器内でのパート数

オーケストラで例えるとトランペット（トラック１）は３人（３チャンネル）
　　　　　　　　　　　トロンボーン（トラック２）は３人（３チャンネル）
　　　　　　　　　　　ホルン（トラック３）は３人（３チャンネル）　　　　　　　　　　　
　　　　　　　　　　　フルート（トラック４）は３人（３チャンネル）　
　　　　　　　　　　　ピアノ（トラック５）は３人（３チャンネル）
		　　　バイオリン（トラック６）は３人（３チャンネル）、計１８人で演奏しているイメージです

経験上、トラックの限界は６だと思われます。７だとギリギリ、８は相当怪しいです。
ゲーム上で使う場面にもよりますが、始めはトラックを６個にしておきましょう。
チャンネルの限界は３、相当怪しいは４で、５はアウトだと思ってください。
慣れれば増やせる場面と駄目な場面が分かると思います。

ドラムを一つ使うので実質使える楽器の数は５になります。
上のように６トラック、全３チャンネルという事は１８個の五線譜がある、という事になります。
GBAFEの仕様上、１８個はギリギリです。音が抜ける可能性が非常に高いので上手く調整する技術が必要になります。
（この限界を超える方法もあるのですが、私はよく分かりません）
この場合、私なら１８個のチャンネルを１４個程度に減らすか圧縮するという方法を使っています
この辺りは使用するシーケンサ次第ですので、各々でやり易い方法を見つけてください。


MIDIの調整はMIDI移植における肝です。
オリジナルmidiを少ない楽器数で再現する事が重要です。
Gジェネレーション アドバンスのinstを使った場合、音量は35が基本値でお好みで上下させてください。
メインパートが弱ければ大きく、ドラムが大きければ小さく、という感じです。
ただしトラックの音量は統一してください。

　　　　駄目な音量調整　　　　　　　　　　　　　　良い音量調整
１８トラック（６楽器）の全１チャンネル　　６トラック（６楽器）の全３チャンネル
　　楽器１　　音量　５０　　　　　　　　　　　楽器１　　音量５０
　　楽器１　　音量　４５　　　　　　　　　　　楽器１　　音量５０
　　楽器１　　音量　４０　　　　　　　　　　　楽器１　　音量５０
　　楽器２　　音量　３０　　　　　　　　　　　楽器２　　音量６０
　　楽器２　　音量　５０　　　　　　　　　　　楽器２　　音量６０
　　楽器２　　音量　４５　　　　　　　　　　　楽器２　　音量６０
　　楽器３　　音量　４０　　　　　　　　　　　楽器３　　音量３５
　　楽器３　　音量　３０　　　　　　　　　　　楽器３　　音量３５
　　楽器３　　音量　３５　　　　　→　　　　　楽器３　　音量３５
　　楽器４　　音量　３０　　　　　　　　　　　楽器４　　音量４５
　　楽器４　　音量　２５　　　　　　　　　　　楽器４　　音量４５
　　楽器４　　音量　７０　　　　　　　　　　　楽器４　　音量４５
　　楽器５　　音量　６０　　　　　　　　　　　楽器５　　音量４０
　　楽器５　　音量　４０　　　　　　　　　　　楽器５　　音量４０
　　楽器５　　音量　１０　　　　　　　　　　　楽器５　　音量４０
　　楽器６　　音量　２０　　　　　　　　　　　楽器６　　音量２５
　　楽器６　　音量　１５　　　　　　　　　　　楽器６　　音量２５
　　楽器６　　音量　３５　　　　　　　　　　　楽器６　　音量２５

左の場合、楽器は統一されていますが音量がバラバラです。
これだとチャンネルが統一されません。
なので右のように調整する必要があります。

③
Midi2GBAにmidiをドロップします。
するとsファイルができるのでsappy2006mod10.1を使って移植します。
Assemble song
　　　↓
さっき作ったSファイルを指定
　　　↓
bese offsetは移植する場所です、空き領域を指定しましょう（以降、始めに0xをつけるのを忘れずに！）
　　　↓
voice group addressは移植したGジェネレーション アドバンスのinstを選択しましょう
　　　↓
MST offsetは曲番号のことなので、普通の音楽移植の①と同じです
　　　↓
cook it をクリックします
ここでパスが見つかれないというエラーが出る場合があります
その場合は音楽を再生している最中に移植してみてください
このエラーは何が原因で起こるのかいまいち分かっていません
私もしばらくエラー続きだったのですが、いつのまにか出来るようになってました

移植した音楽を聴いてみると、おそらく酷い事になると思います。
なので…

④
メモ帳で開きます。
一番重要なのはVOICE（楽器です）。
上のように調整すればトラックは６個になります。
調整したとおりにVOICEが設定されていると思いますがinstが違うので楽器の場所も違います。
普通のシーケンサだった場合、0はピアノです。40はバイオリン、56はトランペット、73はフルートとなっています。
しかし今回使っているinstだった場合は全ての違う楽器が設定されています。
例えばフルートは16か19を使う事になると思います。
必要な所は自分で調べましょう。
（音の感覚が人によって違うためです。
　スクエアウェーブ、ストリングスと言われてどんな音をイメージするか？と言う部分です）
トラック６と考えれば一度に６楽器調べられるので、２１回試せば全ての楽器が分かると思います。
耳がよければそれでいいですが、分からなければ一つだけ音量を上げて後全ての音量を0にすればわかると思います。
127回チェックする必要がありますが…ここで全ての楽器を調べておくと曲の完成度が飛躍的に高まります。
Sファイル上でのvolが音量です。

⑤
上手く音楽が鳴るようなったら今度はSファイル上での音楽編集となります。
まず曲の始まりのwaitを06～12程度にしてください。
（使ったmidiによって始まりのwaitが違います）
ループ処理を加えて終了となります。
ループすると音が間延びしたりする場合はその部分を変える必要があります。
その辺りは経験と推測なので、特に記述できません。
ここは経験が必要な部分ですが、完成度を上げるには避けて通れない部分です。

面倒ですが別のシーケンサで調整し直せば、Sファイルの編集は少なくてすみます。
Sファイルで編集した方が断然早いので、Sファイルの編集に慣れる事をお勧めしますが…

大体これで音は鳴ると思います。
音楽移植はケースバイケースがほとんどです。
どうすれば正解、という物ではなく、上手くなれば正解、と考えるといいと思います。

後、ジージェネレーションinst（結構適当）

0ギター
1トランペット
2ストレングス（弱）
3トロンボーン？
4ティンパニー
5ピアノ（重・低音）
6ピアノ（ギター）
7スクエアウェーブ
8ホルン
9アコーディオン？
10ディストーションギター
11×
12エレキギター
13オルガン
14チューバ
15？
16フルート
17ピアノ（弱）
18クアイア？
19フレンチホルン？
20クラリネット？
21オーボエ？
22ストレングス？
23オルゴール
24エレキギター（重）
25コーラス？
26コーラス
27オーケストラ？
28スラップベース
29オーケストラヒット
30オーボエ？
31ブラス（弱）？
32クラリネット（高）？
33リードオルガン？
34ソフトウェーブ
35？
36スラップギター
37ブライトネス系？
38？
39ブライトネス（硬）
40フルート・リコーダー？
41ギター？
42ギター？
43？
44ブラス？
45鉄琴
46オーバードライブギター？
47×ガンショット
48スクエアウェーブ
49スラップギター（途切れる）
50スラップギター（途切れる）
51？
52鉄琴
53フレンチホルン？
54×
55ピアノ+コーラス（ストレングスギター？）鉄琴？
56トランペット
57×
58ブラス
59トロンボーン？
60ギター
61？
62コーラス＋ピアノ
63オーボエ？
64クラリネット？
65スクエアウェーブ？
66ソフトウェーブ？
67ウェーブ？
68ウェーブ？
69ウェーブ？

124ウェーブ？
125×
126ガンショット
127ドラム

Ｓファイル編集のとき
TIEは全部N48やN24に変更した方が良い
音を伸ばすという命令なんだろうが、
ループしてるのにずっとなり続けたりする
ループするたんびにどんどん音が増えたり
